<!DOCTYPE html>
<html
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{layouts/default-layout}">
  
<head>
<th:block layout:fragment="css">
	<link rel="stylesheet" href="/css/login.css">
</th:block>

<th:block layout:fragment="script">
   <script type="text/javascript" th:inline="javascript">
   //글 등록
   $(function() {
        $("#btnInsert").on("click", () => {

          //입력 유효성 검사
          if($("#boardTitle").val() === "") {
            alert("제목을 입력하세요.");
            $("#boardTitle").focus();
            return;
          }

          if($("#boardContent").val() === "") {
            alert("내용을 입력하세요.");
            $("#boardContent").focus();
            return;
          }

          //ajax로 db조회
          $.ajax({
            url: "/board/board-insert",
            type: "POST",
            data: $("#insertForm").serialize(),
            success: (result) => {
              console.log(result);
              alert(result.msg);
              window.location.href="/qnaPage";
            },
            error: (error) => {
              console.log(error);
              alert("글 등록 실패");
            }
          });
        });
      });

   </script>
</th:block>
    
</head>

<body> 
<th:block layout:fragment="content">  
<div style="display: flex; flex-direction: column; justify-content: center; align-items: center;">
  <h3>새 글 등록</h3>
  <form id="insertForm" action="/board/board-insert" method="post" enctype="multipart/form-data">
    <table border="1" style="border-collapse: collapse">
      <tr>
        <td style="background: skyblue; width: 70px;">
          제목
        </td>
        <td style="text-align: left;">
          <input type="text" name="boardTitle">
        </td>
      </tr>
      <tr>
        <td style="background: skyblue;">
          작성자
        </td>
        <td style="text-align: left;">
          <input type="text" name="boardWriter">
        </td>
      </tr>
      <tr>
        <td style="background: skyblue; width: 70px;">
          내용
        </td>
        <td style="text-align: left;">
          <textarea name="boardContent" cols="40" rows="10"></textarea>
        </td>
      </tr>
      <tr>
        <td style="background: skyblue; width: 70px;">
          파일첨부
        </td>
        <td>
          <div id="image_preview">
            <input type="file" id="btnAtt"
                   name="uploadFiles" multiple>
            <div id="attZone"
                 data-placeholder="파일을 첨부하려면 파일선택 버튼을 누르세요.">
            </div>
          </div>
        </td>
      </tr>
      <tr>
        <td colspan="2" align="center">
          <button type="button" id="btnInsert">새 글 등록</button>
        </td>
      </tr>
    </table>
  </form>
  <hr/>
  <a href="#">글 목록</a>
</div>
</th:block>
</body> 
</html>
